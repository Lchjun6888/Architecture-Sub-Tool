# Excel Splitter App - 프로젝트 가이드 & 상태 보고서

이 문서는 엑셀 분할 애플리케이션의 주요 기능, 설정 및 최근 수정 사항을 정리한 문서입니다. 나중에 프로젝트 내용을 다시 확인하거나 수정할 때 참고하세요.

## 📋 프로젝트 개요
여러 시트가 포함된 대용량 엑셀 파일을 사용자 정의 규칙(줄 수, 키워드 등)에 따라 여러 개의 작은 파일로 자동 분할해주는 도구입니다.

## ✨ 주요 기능 및 특징

### 1. 고정 헤더 (Fixed Header Rows)
- **기능:** 모든 분할된 파일의 상단에 고유한 헤더(제목줄)를 반복해서 삽입합니다.
- **설정:** 기본값 **4행** (건축공사 내역서 양식에 최적화).
- **특징:** 원본의 셀 스타일(색상, 폰트, 테두리 등)과 병합된 셀 구조를 유지하며 복사됩니다.

### 2. 스마트 분할 (Row-based Splitting)
- **기능:** 지정된 데이터 줄 수에 따라 파일을 쪼갭니다.
- **설정:** 기본값 **28줄**. (고정 4행 + 데이터 28행 = 총 32행으로 한 페이지 인쇄 분량에 최적화)
- **보조 기능:** 'Total', 'Subtotal' 등의 키워드를 감지하여 해당 행에서 강제로 페이지를 넘길 수 있는 기능을 포함합니다.

### 3. 실시간 편집 가능한 미리보기 (Editable Data Preview)
- **기능:** 파일을 업로드한 후 앱 내에서 시트 전체 내용을 미리 볼 수 있습니다.
- **편집:** 미리보기 표의 셀을 직접 클릭하여 텍스트를 수정할 수 있습니다.
- **반영:** 수정된 내용은 **파일을 내보낼 때 실제로 적용**되어 저장됩니다. 
- **행 번호:** 테이블 왼쪽에 원본 행 번호가 표시되어 위치 확인이 용이합니다.

### 4. 안정성 확보 (Security & Stability)
- **Shared Formula 오류 해결:** 엑셀의 '공유 수식'이 포함된 데이터를 복사할 때 발생하던 `Shared Formula master must exist` 에러를 방지하도록 방어적 복사 로직을 구현했습니다.
- **에셋 압축:** 분할된 모든 결과물은 하나의 `.zip` 파일로 묶어서 한 번에 다운로드됩니다.

## 🛠 기술 스택
- **Frontend:** React, Tailwind CSS, Lucide-React (Icons)
- **Excel Logic:** `ExcelJS` (정밀한 스타일 복사용), `xlsx` (빠른 데이터 읽기용)
- **Archive:** `jszip`

## 📝 최근 주요 수정 내역 (2026-02-15 기준)
- [x] 'Rows per file' 기본값을 28로 변경하여 인쇄 레이아웃 최적화.
- [x] 미리보기 테이블에 행 번호 표시 및 100% 전체 로딩 구현.
- [x] 미리보기 테이블 내에서 데이터 직접 수정 기능(contentEditable) 추가.
- [x] 단계 전환 시 발생하던 'Confirm' 버튼 클릭 오류(ReferenceError) 수정.

---
**이 문서는 프로젝트의 현재 상태를 가장 잘 나타내고 있습니다. 추가 기능 구현이나 수정이 필요할 때 이 내용을 기반으로 질문해 주세요.**
